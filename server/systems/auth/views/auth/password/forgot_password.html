<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DIT Paperless | Reset Password</title>

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="/adminlte/plugins/fontawesome-free/css/all.min.css">
  <!-- icheck bootstrap -->
  <link rel="stylesheet" href="/adminlte/plugins/icheck-bootstrap/icheck-bootstrap.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="/adminlte/dist/css/adminlte.min.css">

  <style type="text/css">
    #passwordStrength {
      width: 30%;
      height: 5px;
      margin: 5px 0;
      display: none;
    }

    #passwordStrength span {
      position: relative;
      height: 100%;
      width: 100%;
      background: lightgrey;
      border-radius: 5px;
    }

    #passwordStrength span:nth-child(2) {
      margin: 0 3px;
    }

    #passwordStrength span.active:before {
      position: absolute;
      content: '';
      top: 0;
      left: 0;
      height: 100%;
      width: 100%;
      border-radius: 5px;
    }

    #passwordStrength span#poor:before {
      background-color: #ff4757;
    }

    #passwordStrength span#weak:before {
      background-color: orange;
    }

    #passwordStrength span#strong:before {
      background-color: #23ad5c;
    }

    #passwordInfo {
      font-size: 15px;
    }

    #passwordInfo #poor {
      color: red;
    }

    #passwordInfo #weak {
      color: orange;
    }

    #passwordInfo #strong {
      color: green;
    }
  </style>
</head>

<body class="hold-transition login-page">
  <div class="login-box">
    <div class="card card-outline card-dark">
      <br>
      <div class="col-12" style="text-align: center">
        <span class="col-12 " style=" text-align: center; background-color:white;font-size:17px;text-shadow:0.2px 0.2px 0.2px #4C4B4D;
            font-family: 'Seta Reta NF';
            font-weight: 600;
            color: #4C4B4D !important;">
          TRAINING FRONTEND
        </span>
      </div>
      <div class="card-header text-center">
        <img src="/images/dit-logo-transparent.png" alt="" style="width:80px;height:80px"> <br>
      </div>
      <div class="card-body">
        <p class="login-box-msg">Change Your Password.</p>
        <form action="/auth/user-reset-password" method="post">
          <div class="input-group mb-3" id="passwordInput">
            <input type="text" class="form-control" name="password" id="password" placeholder="New Password" required>
            <div class="input-group-append">
              <div class="input-group-text">
                <span class="fa-solid fa-key"></span>
              </div>
            </div>
          </div>
          <div id="passwordStrength">
            <span id="poor"></span>
            <span id="weak"></span>
            <span id="strong"></span>
          </div>
          <div id="passwordInfo"></div>

          <div class="row mt-2">
            <div class="col-12">
              <button type="submit" id="btnSubmit" class="btn btn-primary btn-block" disabled>Change password</button>
            </div>
          </div>
        </form>
        <p class="mt-3 mb-1">
          <a href="/auth/login">Login</a>
        </p>
      </div>
      <!-- /.login-card-body -->
    </div>
  </div>
  <!-- /.login-box -->

  <!-- jQuery -->
  <script src="/adminlte/plugins/jquery/jquery.min.js"></script>
  <!-- Bootstrap 4 -->
  <script src="/adminlte/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
  <!-- AdminLTE App -->
  <script src="/adminlte/dist/js/adminlte.min.js"></script>

  <script>
    let passwordInput = document.querySelector('#passwordInput input[type="text"]');
    let passwordStrength = document.getElementById('passwordStrength');
    let poor = document.querySelector('#passwordStrength #poor');
    let weak = document.querySelector('#passwordStrength #weak');
    let strong = document.querySelector('#passwordStrength #strong');
    let passwordInfo = document.getElementById('passwordInfo');
    const btnSubmit = document.getElementById('btnSubmit');

    let poorRegExp = /[a-z]/;
    let weakRegExp = /(?=.*?[0-9])/;;
    let strongRegExp = /(?=.*?[#?!@$%^&*-])/;
    let whitespaceRegExp = /^$|\s+/;


    passwordInput.oninput = function () {

      let passwordValue = passwordInput.value;
      let passwordLength = passwordValue.length;

      let poorPassword = passwordValue.match(poorRegExp);
      let weakPassword = passwordValue.match(weakRegExp);
      let strongPassword = passwordValue.match(strongRegExp);
      let whitespace = passwordValue.match(whitespaceRegExp);

      if (passwordValue != "") {

        passwordStrength.style.display = "block";
        passwordStrength.style.display = "flex";
        passwordInfo.style.display = "block";
        passwordInfo.style.color = "black";

        if (whitespace) {
          passwordInfo.textContent = "whitespaces are not allowed";
        } else {
          poorPasswordStrength(passwordLength, poorPassword, weakPassword, strongPassword);
          weakPasswordStrength(passwordLength, poorPassword, weakPassword, strongPassword);
          strongPasswordStrength(passwordLength, poorPassword, weakPassword, strongPassword);
        }


      } else {

        passwordStrength.style.display = "none";
        passwordInfo.style.display = "none";

      }
    }

    function poorPasswordStrength(passwordLength, poorPassword, weakPassword, strongPassword) {

      if (passwordLength <= 3 && (poorPassword || weakPassword || strongPassword)) {
        poor.classList.add("active");
        passwordInfo.style.display = "block";
        passwordInfo.style.color = "red";
        passwordInfo.textContent = "Your password is too Poor";
        btnSubmit.disabled = true;
      }
    }

    function weakPasswordStrength(passwordLength, poorPassword, weakPassword, strongPassword) {
      if (passwordLength >= 4 && poorPassword && (weakPassword || strongPassword)) {
        weak.classList.add("active");
        passwordInfo.textContent = "Your password is Weak";
        passwordInfo.style.color = "orange";
        btnSubmit.disabled = true;

      } else {
        weak.classList.remove("active");
        btnSubmit.disabled = true;

      }
    }

    function strongPasswordStrength(passwordLength, poorPassword, weakPassword, strongPassword) {

      if (passwordLength >= 6 && (poorPassword && weakPassword) && strongPassword) {
        poor.classList.add("active");
        weak.classList.add("active");
        strong.classList.add("active");
        passwordInfo.textContent = "Your password is strong";
        passwordInfo.style.color = "green";
        btnSubmit.disabled = false;
      } else {
        strong.classList.remove("active");
        btnSubmit.disabled = true;
      }
    }
  </script>
</body>

</html>